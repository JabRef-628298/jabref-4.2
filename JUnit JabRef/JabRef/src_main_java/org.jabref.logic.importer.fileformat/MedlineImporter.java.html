<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="pt"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../../jacoco-resources/report.gif" type="image/gif"/><title>MedlineImporter.java</title><link rel="stylesheet" href="../../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../../index.html" class="el_report">java (11/05/2018 16:12:58)</a> &gt; <a href="../../index.html" class="el_group">JabRef</a> &gt; <a href="../index.html" class="el_bundle">src/main/java</a> &gt; <a href="index.source.html" class="el_package">org.jabref.logic.importer.fileformat</a> &gt; <span class="el_source">MedlineImporter.java</span></div><h1>MedlineImporter.java</h1><pre class="source lang-java linenums">package org.jabref.logic.importer.fileformat;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.Serializable;
import java.nio.charset.StandardCharsets;
import java.util.ArrayList;
import java.util.Collections;
import java.util.HashMap;
import java.util.List;
import java.util.Locale;
import java.util.Map;
import java.util.Objects;

import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBElement;
import javax.xml.bind.JAXBException;
import javax.xml.bind.Unmarshaller;
import javax.xml.stream.XMLInputFactory;
import javax.xml.stream.XMLStreamException;
import javax.xml.stream.XMLStreamReader;

import org.jabref.logic.importer.Importer;
import org.jabref.logic.importer.ParseException;
import org.jabref.logic.importer.Parser;
import org.jabref.logic.importer.ParserResult;
import org.jabref.logic.importer.fileformat.medline.Abstract;
import org.jabref.logic.importer.fileformat.medline.AbstractText;
import org.jabref.logic.importer.fileformat.medline.AffiliationInfo;
import org.jabref.logic.importer.fileformat.medline.ArticleId;
import org.jabref.logic.importer.fileformat.medline.ArticleIdList;
import org.jabref.logic.importer.fileformat.medline.ArticleTitle;
import org.jabref.logic.importer.fileformat.medline.Author;
import org.jabref.logic.importer.fileformat.medline.AuthorList;
import org.jabref.logic.importer.fileformat.medline.Book;
import org.jabref.logic.importer.fileformat.medline.BookDocument;
import org.jabref.logic.importer.fileformat.medline.BookTitle;
import org.jabref.logic.importer.fileformat.medline.Chemical;
import org.jabref.logic.importer.fileformat.medline.ContributionDate;
import org.jabref.logic.importer.fileformat.medline.DateCompleted;
import org.jabref.logic.importer.fileformat.medline.DateCreated;
import org.jabref.logic.importer.fileformat.medline.DateRevised;
import org.jabref.logic.importer.fileformat.medline.ELocationID;
import org.jabref.logic.importer.fileformat.medline.GeneSymbolList;
import org.jabref.logic.importer.fileformat.medline.GeneralNote;
import org.jabref.logic.importer.fileformat.medline.ISSN;
import org.jabref.logic.importer.fileformat.medline.Investigator;
import org.jabref.logic.importer.fileformat.medline.InvestigatorList;
import org.jabref.logic.importer.fileformat.medline.Journal;
import org.jabref.logic.importer.fileformat.medline.JournalIssue;
import org.jabref.logic.importer.fileformat.medline.Keyword;
import org.jabref.logic.importer.fileformat.medline.KeywordList;
import org.jabref.logic.importer.fileformat.medline.MedlineCitation;
import org.jabref.logic.importer.fileformat.medline.MedlineJournalInfo;
import org.jabref.logic.importer.fileformat.medline.MeshHeading;
import org.jabref.logic.importer.fileformat.medline.MeshHeadingList;
import org.jabref.logic.importer.fileformat.medline.OtherID;
import org.jabref.logic.importer.fileformat.medline.Pagination;
import org.jabref.logic.importer.fileformat.medline.PersonalNameSubject;
import org.jabref.logic.importer.fileformat.medline.PersonalNameSubjectList;
import org.jabref.logic.importer.fileformat.medline.PubDate;
import org.jabref.logic.importer.fileformat.medline.PublicationType;
import org.jabref.logic.importer.fileformat.medline.Publisher;
import org.jabref.logic.importer.fileformat.medline.PubmedArticle;
import org.jabref.logic.importer.fileformat.medline.PubmedArticleSet;
import org.jabref.logic.importer.fileformat.medline.PubmedBookArticle;
import org.jabref.logic.importer.fileformat.medline.PubmedBookArticleSet;
import org.jabref.logic.importer.fileformat.medline.PubmedBookData;
import org.jabref.logic.importer.fileformat.medline.QualifierName;
import org.jabref.logic.importer.fileformat.medline.Section;
import org.jabref.logic.importer.fileformat.medline.Sections;
import org.jabref.logic.importer.fileformat.medline.Text;
import org.jabref.logic.util.FileType;
import org.jabref.model.entry.BibEntry;
import org.jabref.model.entry.FieldName;
import org.jabref.model.strings.StringUtil;

import com.google.common.base.Joiner;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

/**
 * Importer for the Medline/Pubmed format.
 * &lt;p&gt;
 * check here for details on the format
 * https://www.nlm.nih.gov/bsd/licensee/elements_descriptions.html
 */
<span class="fc" id="L90">public class MedlineImporter extends Importer implements Parser {</span>

<span class="fc" id="L92">    private static final Logger LOGGER = LoggerFactory.getLogger(MedlineImporter.class);</span>
    private static final String KEYWORD_SEPARATOR = &quot;; &quot;;

<span class="fc" id="L95">    private static final Locale ENGLISH = Locale.ENGLISH;</span>
    private Unmarshaller unmarshaller;

    private static String join(List&lt;String&gt; list, String string) {
<span class="fc" id="L99">        return Joiner.on(string).join(list);</span>
    }

    @Override
    public String getName() {
<span class="fc" id="L104">        return &quot;Medline/PubMed&quot;;</span>
    }

    @Override
    public FileType getFileType() {
<span class="fc" id="L109">        return FileType.MEDLINE;</span>
    }

    @Override
    public String getId() {
<span class="fc" id="L114">        return &quot;medline&quot;;</span>
    }

    @Override
    public String getDescription() {
<span class="fc" id="L119">        return &quot;Importer for the Medline format.&quot;;</span>
    }

    @Override
    public boolean isRecognizedFormat(BufferedReader reader) throws IOException {
        String str;
<span class="fc" id="L125">        int i = 0;</span>
<span class="fc bfc" id="L126" title="All 4 branches covered.">        while (((str = reader.readLine()) != null) &amp;&amp; (i &lt; 50)) {</span>

<span class="fc bfc" id="L128" title="All 2 branches covered.">            if (str.toLowerCase(ENGLISH).contains(&quot;&lt;pubmedarticle&gt;&quot;)</span>
<span class="fc bfc" id="L129" title="All 2 branches covered.">                    || str.toLowerCase(ENGLISH).contains(&quot;&lt;pubmedbookarticle&gt;&quot;)) {</span>
<span class="fc" id="L130">                return true;</span>
            }

<span class="fc" id="L133">            i++;</span>
        }
<span class="fc" id="L135">        return false;</span>
    }

    @Override
    public ParserResult importDatabase(BufferedReader reader) throws IOException {
<span class="fc" id="L140">        Objects.requireNonNull(reader);</span>

<span class="fc" id="L142">        List&lt;BibEntry&gt; bibItems = new ArrayList&lt;&gt;();</span>

        try {
<span class="fc" id="L145">            Object unmarshalledObject = unmarshallRoot(reader);</span>

            //check whether we have an article set, an article, a book article or a book article set
<span class="fc bfc" id="L148" title="All 2 branches covered.">            if (unmarshalledObject instanceof PubmedArticleSet) {</span>
<span class="fc" id="L149">                PubmedArticleSet articleSet = (PubmedArticleSet) unmarshalledObject;</span>
<span class="fc bfc" id="L150" title="All 2 branches covered.">                for (Object article : articleSet.getPubmedArticleOrPubmedBookArticle()) {</span>
<span class="fc bfc" id="L151" title="All 2 branches covered.">                    if (article instanceof PubmedArticle) {</span>
<span class="fc" id="L152">                        PubmedArticle currentArticle = (PubmedArticle) article;</span>
<span class="fc" id="L153">                        parseArticle(currentArticle, bibItems);</span>
                    }
<span class="fc bfc" id="L155" title="All 2 branches covered.">                    if (article instanceof PubmedBookArticle) {</span>
<span class="fc" id="L156">                        PubmedBookArticle currentArticle = (PubmedBookArticle) article;</span>
<span class="fc" id="L157">                        parseBookArticle(currentArticle, bibItems);</span>
                    }
                }
<span class="fc bfc" id="L160" title="All 2 branches covered.">            } else if (unmarshalledObject instanceof PubmedArticle) {</span>
<span class="fc" id="L161">                PubmedArticle article = (PubmedArticle) unmarshalledObject;</span>
<span class="fc" id="L162">                parseArticle(article, bibItems);</span>
<span class="fc bfc" id="L163" title="All 2 branches covered.">            } else if (unmarshalledObject instanceof PubmedBookArticle) {</span>
<span class="fc" id="L164">                PubmedBookArticle currentArticle = (PubmedBookArticle) unmarshalledObject;</span>
<span class="fc" id="L165">                parseBookArticle(currentArticle, bibItems);</span>
<span class="fc" id="L166">            } else {</span>
<span class="fc" id="L167">                PubmedBookArticleSet bookArticleSet = (PubmedBookArticleSet) unmarshalledObject;</span>
<span class="fc bfc" id="L168" title="All 2 branches covered.">                for (PubmedBookArticle bookArticle : bookArticleSet.getPubmedBookArticle()) {</span>
<span class="fc" id="L169">                    parseBookArticle(bookArticle, bibItems);</span>
                }
            }
<span class="fc" id="L172">        } catch (JAXBException | XMLStreamException e) {</span>
<span class="fc" id="L173">            LOGGER.debug(&quot;could not parse document&quot;, e);</span>
<span class="fc" id="L174">            return ParserResult.fromError(e);</span>
        }
<span class="fc" id="L176">        return new ParserResult(bibItems);</span>
    }

    private Object unmarshallRoot(BufferedReader reader) throws JAXBException, XMLStreamException {
<span class="fc" id="L180">        initUmarshaller();</span>

<span class="fc" id="L182">        XMLInputFactory xmlInputFactory = XMLInputFactory.newFactory();</span>
<span class="fc" id="L183">        XMLStreamReader xmlStreamReader = xmlInputFactory.createXMLStreamReader(reader);</span>

        //go to the root element
<span class="fc bfc" id="L186" title="All 2 branches covered.">        while (!xmlStreamReader.isStartElement()) {</span>
<span class="fc" id="L187">            xmlStreamReader.next();</span>
        }

<span class="fc" id="L190">        return unmarshaller.unmarshal(xmlStreamReader);</span>
    }

    private void initUmarshaller() throws JAXBException {
<span class="pc bpc" id="L194" title="1 of 2 branches missed.">        if (unmarshaller == null) {</span>
            // Lazy init because this is expensive
<span class="fc" id="L196">            JAXBContext context = JAXBContext.newInstance(&quot;org.jabref.logic.importer.fileformat.medline&quot;);</span>
<span class="fc" id="L197">            unmarshaller = context.createUnmarshaller();</span>
        }
<span class="fc" id="L199">    }</span>

    private void parseBookArticle(PubmedBookArticle currentArticle, List&lt;BibEntry&gt; bibItems) {
<span class="fc" id="L202">        Map&lt;String, String&gt; fields = new HashMap&lt;&gt;();</span>
<span class="pc bpc" id="L203" title="1 of 2 branches missed.">        if (currentArticle.getBookDocument() != null) {</span>
<span class="fc" id="L204">            BookDocument bookDocument = currentArticle.getBookDocument();</span>
<span class="fc" id="L205">            fields.put(FieldName.PMID, bookDocument.getPMID().getContent());</span>
<span class="fc bfc" id="L206" title="All 2 branches covered.">            if (bookDocument.getDateRevised() != null) {</span>
<span class="fc" id="L207">                DateRevised dateRevised = bookDocument.getDateRevised();</span>
<span class="fc" id="L208">                addDateRevised(fields, dateRevised);</span>
            }
<span class="fc bfc" id="L210" title="All 2 branches covered.">            if (bookDocument.getAbstract() != null) {</span>
<span class="fc" id="L211">                Abstract abs = bookDocument.getAbstract();</span>
<span class="fc" id="L212">                addAbstract(fields, abs);</span>
            }
<span class="fc bfc" id="L214" title="All 2 branches covered.">            if (bookDocument.getPagination() != null) {</span>
<span class="fc" id="L215">                Pagination pagination = bookDocument.getPagination();</span>
<span class="fc" id="L216">                addPagination(fields, pagination);</span>
            }
<span class="fc bfc" id="L218" title="All 2 branches covered.">            if (bookDocument.getSections() != null) {</span>
<span class="fc" id="L219">                ArrayList&lt;String&gt; result = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L220">                Sections sections = bookDocument.getSections();</span>
<span class="fc bfc" id="L221" title="All 2 branches covered.">                for (Section section : sections.getSection()) {</span>
<span class="fc bfc" id="L222" title="All 2 branches covered.">                    for (Serializable content : section.getSectionTitle().getContent()) {</span>
<span class="pc bpc" id="L223" title="1 of 2 branches missed.">                        if (content instanceof String) {</span>
<span class="fc" id="L224">                            result.add((String) content);</span>
                        }
                    }
                }
<span class="fc" id="L228">                fields.put(&quot;sections&quot;, join(result, &quot;; &quot;));</span>
            }
<span class="pc bpc" id="L230" title="1 of 2 branches missed.">            if (bookDocument.getKeywordList() != null) {</span>
<span class="fc" id="L231">                addKeyWords(fields, bookDocument.getKeywordList());</span>
            }
<span class="fc bfc" id="L233" title="All 2 branches covered.">            if (bookDocument.getContributionDate() != null) {</span>
<span class="fc" id="L234">                addContributionDate(fields, bookDocument.getContributionDate());</span>
            }
<span class="pc bpc" id="L236" title="1 of 2 branches missed.">            if (bookDocument.getPublicationType() != null) {</span>
<span class="fc" id="L237">                List&lt;String&gt; result = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L238" title="All 2 branches covered.">                for (PublicationType type : bookDocument.getPublicationType()) {</span>
<span class="pc bpc" id="L239" title="1 of 2 branches missed.">                    if (type.getContent() != null) {</span>
<span class="fc" id="L240">                        result.add(type.getContent());</span>
                    }
                }
<span class="fc" id="L243">                fields.put(&quot;pubtype&quot;, join(result, &quot;, &quot;));</span>
            }
<span class="fc bfc" id="L245" title="All 2 branches covered.">            if (bookDocument.getArticleTitle() != null) {</span>
<span class="fc" id="L246">                ArticleTitle articleTitle = bookDocument.getArticleTitle();</span>
<span class="fc" id="L247">                ArrayList&lt;String&gt; titles = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L248" title="All 2 branches covered.">                for (Serializable content : articleTitle.getContent()) {</span>
<span class="pc bpc" id="L249" title="1 of 2 branches missed.">                    if (content instanceof String) {</span>
<span class="fc" id="L250">                        titles.add((String) content);</span>
                    }
                }
<span class="fc" id="L253">                fields.put(&quot;article&quot;, join(titles, &quot;, &quot;));</span>
            }
<span class="fc bfc" id="L255" title="All 2 branches covered.">            if (bookDocument.getBook() != null) {</span>
<span class="fc" id="L256">                addBookInformation(fields, bookDocument.getBook());</span>
            }
        }

<span class="fc bfc" id="L260" title="All 2 branches covered.">        if (currentArticle.getPubmedBookData() != null) {</span>
<span class="fc" id="L261">            PubmedBookData bookData = currentArticle.getPubmedBookData();</span>
<span class="fc" id="L262">            putIfValueNotNull(fields, &quot;pubstatus&quot;, bookData.getPublicationStatus());</span>
        }

<span class="fc" id="L265">        BibEntry entry = new BibEntry(&quot;article&quot;);</span>
<span class="fc" id="L266">        entry.setField(fields);</span>

<span class="fc" id="L268">        bibItems.add(entry);</span>
<span class="fc" id="L269">    }</span>

    private void addBookInformation(Map&lt;String, String&gt; fields, Book book) {
<span class="pc bpc" id="L272" title="1 of 2 branches missed.">        if (book.getPublisher() != null) {</span>
<span class="fc" id="L273">            Publisher publisher = book.getPublisher();</span>
<span class="fc" id="L274">            putIfValueNotNull(fields, &quot;publocation&quot;, publisher.getPublisherLocation());</span>
<span class="fc" id="L275">            putStringFromSerializableList(fields, FieldName.PUBLISHER, publisher.getPublisherName().getContent());</span>
        }
<span class="pc bpc" id="L277" title="1 of 2 branches missed.">        if (book.getBookTitle() != null) {</span>
<span class="fc" id="L278">            BookTitle title = book.getBookTitle();</span>
<span class="fc" id="L279">            putStringFromSerializableList(fields, FieldName.TITLE, title.getContent());</span>
        }
<span class="pc bpc" id="L281" title="1 of 2 branches missed.">        if (book.getPubDate() != null) {</span>
<span class="fc" id="L282">            addPubDate(fields, book.getPubDate());</span>
        }
<span class="pc bpc" id="L284" title="1 of 2 branches missed.">        if (book.getAuthorList() != null) {</span>
<span class="fc" id="L285">            List&lt;AuthorList&gt; authorLists = book.getAuthorList();</span>
            //authorLists size should be one
<span class="pc bpc" id="L287" title="1 of 2 branches missed.">            if (authorLists.size() == 1) {</span>
<span class="fc bfc" id="L288" title="All 2 branches covered.">                for (AuthorList authorList : authorLists) {</span>
<span class="fc" id="L289">                    handleAuthors(fields, authorList);</span>
                }
<span class="fc" id="L291">            } else {</span>
<span class="nc" id="L292">                LOGGER.info(String.format(&quot;Size of authorlist was %s&quot;, authorLists.size()));</span>
            }
        }

<span class="fc" id="L296">        putIfValueNotNull(fields, FieldName.VOLUME, book.getVolume());</span>
<span class="fc" id="L297">        putIfValueNotNull(fields, FieldName.EDITION, book.getEdition());</span>
<span class="fc" id="L298">        putIfValueNotNull(fields, &quot;medium&quot;, book.getMedium());</span>
<span class="fc" id="L299">        putIfValueNotNull(fields, &quot;reportnumber&quot;, book.getReportNumber());</span>

<span class="pc bpc" id="L301" title="1 of 2 branches missed.">        if (book.getELocationID() != null) {</span>
<span class="fc bfc" id="L302" title="All 2 branches covered.">            for (ELocationID id : book.getELocationID()) {</span>
<span class="fc" id="L303">                addElocationID(fields, id);</span>
            }
        }
<span class="pc bpc" id="L306" title="1 of 2 branches missed.">        if (book.getIsbn() != null) {</span>
<span class="fc" id="L307">            fields.put(FieldName.ISBN, join(book.getIsbn(), &quot;, &quot;));</span>
        }
<span class="fc" id="L309">    }</span>

    private void putStringFromSerializableList(Map&lt;String, String&gt; fields, String medlineKey,
            List&lt;Serializable&gt; contentList) {
<span class="fc" id="L313">        StringBuilder result = new StringBuilder();</span>
<span class="fc bfc" id="L314" title="All 2 branches covered.">        for (Serializable content : contentList) {</span>
<span class="pc bpc" id="L315" title="1 of 2 branches missed.">            if (content instanceof String) {</span>
<span class="fc" id="L316">                result.append((String) content);</span>
            }
        }
<span class="pc bpc" id="L319" title="1 of 2 branches missed.">        if (result.length() &gt; 0) {</span>
<span class="fc" id="L320">            fields.put(medlineKey, result.toString());</span>
        }
<span class="fc" id="L322">    }</span>

    private void addContributionDate(Map&lt;String, String&gt; fields, ContributionDate contributionDate) {
<span class="pc bpc" id="L325" title="2 of 4 branches missed.">        if ((contributionDate.getDay() != null) &amp;&amp; (contributionDate.getMonth() != null)</span>
<span class="pc bpc" id="L326" title="1 of 2 branches missed.">                &amp;&amp; (contributionDate.getYear() != null)) {</span>
<span class="fc" id="L327">            String result = convertToDateFormat(contributionDate.getYear(), contributionDate.getMonth(),</span>
<span class="fc" id="L328">                    contributionDate.getDay());</span>
<span class="fc" id="L329">            fields.put(&quot;contribution&quot;, result);</span>
        }
<span class="fc" id="L331">    }</span>

    private String convertToDateFormat(String year, String month, String day) {
<span class="fc" id="L334">        return String.format(&quot;%s-%s-%s&quot;, year, month, day);</span>
    }

    private void parseArticle(PubmedArticle article, List&lt;BibEntry&gt; bibItems) {
<span class="fc" id="L338">        Map&lt;String, String&gt; fields = new HashMap&lt;&gt;();</span>

<span class="fc bfc" id="L340" title="All 2 branches covered.">        if (article.getPubmedData() != null) {</span>
<span class="fc bfc" id="L341" title="All 2 branches covered.">            if (article.getMedlineCitation().getDateRevised() != null) {</span>
<span class="fc" id="L342">                DateRevised dateRevised = article.getMedlineCitation().getDateRevised();</span>
<span class="fc" id="L343">                addDateRevised(fields, dateRevised);</span>
<span class="fc" id="L344">                putIfValueNotNull(fields, &quot;pubstatus&quot;, article.getPubmedData().getPublicationStatus());</span>
<span class="pc bpc" id="L345" title="1 of 2 branches missed.">                if (article.getPubmedData().getArticleIdList() != null) {</span>
<span class="fc" id="L346">                    ArticleIdList articleIdList = article.getPubmedData().getArticleIdList();</span>
<span class="fc" id="L347">                    addArticleIdList(fields, articleIdList);</span>
                }
            }
        }
<span class="fc bfc" id="L351" title="All 2 branches covered.">        if (article.getMedlineCitation() != null) {</span>
<span class="fc" id="L352">            MedlineCitation medlineCitation = article.getMedlineCitation();</span>

<span class="fc" id="L354">            fields.put(&quot;status&quot;, medlineCitation.getStatus());</span>
<span class="fc" id="L355">            DateCreated dateCreated = medlineCitation.getDateCreated();</span>
<span class="fc bfc" id="L356" title="All 2 branches covered.">            if (medlineCitation.getDateCreated() != null) {</span>
<span class="fc" id="L357">                fields.put(&quot;created&quot;,</span>
<span class="fc" id="L358">                        convertToDateFormat(dateCreated.getYear(), dateCreated.getMonth(), dateCreated.getDay()));</span>
            }
<span class="fc" id="L360">            fields.put(&quot;pubmodel&quot;, medlineCitation.getArticle().getPubModel());</span>

<span class="fc bfc" id="L362" title="All 2 branches covered.">            if (medlineCitation.getDateCompleted() != null) {</span>
<span class="fc" id="L363">                DateCompleted dateCompleted = medlineCitation.getDateCompleted();</span>
<span class="fc" id="L364">                fields.put(&quot;completed&quot;,</span>
<span class="fc" id="L365">                        convertToDateFormat(dateCompleted.getYear(), dateCompleted.getMonth(), dateCompleted.getDay()));</span>
            }

<span class="fc" id="L368">            fields.put(FieldName.PMID, medlineCitation.getPMID().getContent());</span>
<span class="fc" id="L369">            fields.put(FieldName.OWNER, medlineCitation.getOwner());</span>

<span class="fc" id="L371">            addArticleInformation(fields, medlineCitation.getArticle().getContent());</span>

<span class="fc" id="L373">            MedlineJournalInfo medlineJournalInfo = medlineCitation.getMedlineJournalInfo();</span>
<span class="fc" id="L374">            putIfValueNotNull(fields, &quot;country&quot;, medlineJournalInfo.getCountry());</span>
<span class="fc" id="L375">            putIfValueNotNull(fields, &quot;journal-abbreviation&quot;, medlineJournalInfo.getMedlineTA());</span>
<span class="fc" id="L376">            putIfValueNotNull(fields, &quot;nlm-id&quot;, medlineJournalInfo.getNlmUniqueID());</span>
<span class="fc" id="L377">            putIfValueNotNull(fields, &quot;issn-linking&quot;, medlineJournalInfo.getISSNLinking());</span>
<span class="fc bfc" id="L378" title="All 2 branches covered.">            if (medlineCitation.getChemicalList() != null) {</span>
<span class="pc bpc" id="L379" title="1 of 2 branches missed.">                if (medlineCitation.getChemicalList().getChemical() != null) {</span>
<span class="fc" id="L380">                    addChemicals(fields, medlineCitation.getChemicalList().getChemical());</span>
                }
            }
<span class="pc bpc" id="L383" title="1 of 2 branches missed.">            if (medlineCitation.getCitationSubset() != null) {</span>
<span class="fc" id="L384">                fields.put(&quot;citation-subset&quot;, join(medlineCitation.getCitationSubset(), &quot;, &quot;));</span>
            }
<span class="fc bfc" id="L386" title="All 2 branches covered.">            if (medlineCitation.getGeneSymbolList() != null) {</span>
<span class="fc" id="L387">                addGeneSymbols(fields, medlineCitation.getGeneSymbolList());</span>
            }
<span class="fc bfc" id="L389" title="All 2 branches covered.">            if (medlineCitation.getMeshHeadingList() != null) {</span>
<span class="fc" id="L390">                addMeashHeading(fields, medlineCitation.getMeshHeadingList());</span>
            }
<span class="fc" id="L392">            putIfValueNotNull(fields, &quot;references&quot;, medlineCitation.getNumberOfReferences());</span>
<span class="fc bfc" id="L393" title="All 2 branches covered.">            if (medlineCitation.getPersonalNameSubjectList() != null) {</span>
<span class="fc" id="L394">                addPersonalNames(fields, medlineCitation.getPersonalNameSubjectList());</span>
            }
<span class="pc bpc" id="L396" title="1 of 2 branches missed.">            if (medlineCitation.getOtherID() != null) {</span>
<span class="fc" id="L397">                addOtherId(fields, medlineCitation.getOtherID());</span>
            }
<span class="pc bpc" id="L399" title="1 of 2 branches missed.">            if (medlineCitation.getKeywordList() != null) {</span>
<span class="fc" id="L400">                addKeyWords(fields, medlineCitation.getKeywordList());</span>
            }
<span class="pc bpc" id="L402" title="1 of 2 branches missed.">            if (medlineCitation.getSpaceFlightMission() != null) {</span>
<span class="fc" id="L403">                fields.put(&quot;space-flight-mission&quot;, join(medlineCitation.getSpaceFlightMission(), &quot;, &quot;));</span>
            }
<span class="fc bfc" id="L405" title="All 2 branches covered.">            if (medlineCitation.getInvestigatorList() != null) {</span>
<span class="fc" id="L406">                addInvestigators(fields, medlineCitation.getInvestigatorList());</span>
            }
<span class="pc bpc" id="L408" title="1 of 2 branches missed.">            if (medlineCitation.getGeneralNote() != null) {</span>
<span class="fc" id="L409">                addNotes(fields, medlineCitation.getGeneralNote());</span>
            }
        }

<span class="fc" id="L413">        BibEntry entry = new BibEntry(&quot;article&quot;);</span>
<span class="fc" id="L414">        entry.setField(fields);</span>

<span class="fc" id="L416">        bibItems.add(entry);</span>
<span class="fc" id="L417">    }</span>

    private void addArticleIdList(Map&lt;String, String&gt; fields, ArticleIdList articleIdList) {
<span class="fc bfc" id="L420" title="All 2 branches covered.">        for (ArticleId id : articleIdList.getArticleId()) {</span>
<span class="pc bpc" id="L421" title="1 of 2 branches missed.">            if (id.getIdType() != null) {</span>
<span class="fc bfc" id="L422" title="All 2 branches covered.">                if (&quot;pubmed&quot;.equals(id.getIdType())) {</span>
<span class="fc" id="L423">                    fields.put(&quot;pmid&quot;, id.getContent());</span>
<span class="fc" id="L424">                } else {</span>
<span class="fc" id="L425">                    fields.put(id.getIdType(), id.getContent());</span>
                }
            }
        }
<span class="fc" id="L429">    }</span>

    private void addNotes(Map&lt;String, String&gt; fields, List&lt;GeneralNote&gt; generalNote) {
<span class="fc" id="L432">        List&lt;String&gt; notes = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L433" title="All 2 branches covered.">        for (GeneralNote note : generalNote) {</span>
<span class="pc bpc" id="L434" title="1 of 2 branches missed.">            if (note != null) {</span>
<span class="fc" id="L435">                notes.add(note.getContent());</span>
            }
        }
<span class="fc" id="L438">        fields.put(FieldName.NOTE, join(notes, &quot;, &quot;));</span>
<span class="fc" id="L439">    }</span>

    private void addInvestigators(Map&lt;String, String&gt; fields, InvestigatorList investigatorList) {
<span class="fc" id="L442">        List&lt;String&gt; investigatorNames = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L443">        List&lt;String&gt; affiliationInfos = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L444">        String name = &quot;&quot;;</span>
        // add the investigators like the authors
<span class="pc bpc" id="L446" title="1 of 2 branches missed.">        if (investigatorList.getInvestigator() != null) {</span>
<span class="fc" id="L447">            List&lt;Investigator&gt; investigators = investigatorList.getInvestigator();</span>
<span class="fc bfc" id="L448" title="All 2 branches covered.">            for (Investigator investigator : investigators) {</span>
<span class="fc" id="L449">                name = investigator.getLastName();</span>
<span class="pc bpc" id="L450" title="1 of 2 branches missed.">                if (investigator.getForeName() != null) {</span>
<span class="fc" id="L451">                    name += &quot;, &quot; + investigator.getForeName();</span>
                }
<span class="fc" id="L453">                investigatorNames.add(name);</span>

                //now add the affiliation info
<span class="pc bpc" id="L456" title="1 of 2 branches missed.">                if (investigator.getAffiliationInfo() != null) {</span>
<span class="fc bfc" id="L457" title="All 2 branches covered.">                    for (AffiliationInfo info : investigator.getAffiliationInfo()) {</span>
<span class="fc bfc" id="L458" title="All 2 branches covered.">                        for (Serializable affiliation : info.getAffiliation().getContent()) {</span>
<span class="pc bpc" id="L459" title="1 of 2 branches missed.">                            if (affiliation instanceof String) {</span>
<span class="fc" id="L460">                                affiliationInfos.add((String) affiliation);</span>
                            }
                        }
                    }
<span class="fc" id="L464">                    fields.put(&quot;affiliation&quot;, join(affiliationInfos, &quot;, &quot;));</span>
                }
            }
<span class="fc" id="L467">            fields.put(&quot;investigator&quot;, join(investigatorNames, &quot; and &quot;));</span>
        }
<span class="fc" id="L469">    }</span>

    private void addKeyWords(Map&lt;String, String&gt; fields, List&lt;KeywordList&gt; allKeywordLists) {
<span class="fc" id="L472">        List&lt;String&gt; keywordStrings = new ArrayList&lt;&gt;();</span>
        //add keywords to the list
<span class="fc bfc" id="L474" title="All 2 branches covered.">        for (KeywordList keywordList : allKeywordLists) {</span>
<span class="fc bfc" id="L475" title="All 2 branches covered.">            for (Keyword keyword : keywordList.getKeyword()) {</span>
<span class="fc bfc" id="L476" title="All 2 branches covered.">                for (Serializable content : keyword.getContent()) {</span>
<span class="pc bpc" id="L477" title="1 of 2 branches missed.">                    if (content instanceof String) {</span>
<span class="fc" id="L478">                        keywordStrings.add((String) content);</span>
                    }
                }
            }
        }
        //Check whether MeshHeadingList exist or not
<span class="fc bfc" id="L484" title="All 2 branches covered.">        if (fields.get(FieldName.KEYWORDS) == null) {</span>
<span class="fc" id="L485">            fields.put(FieldName.KEYWORDS, join(keywordStrings, KEYWORD_SEPARATOR));</span>
<span class="fc" id="L486">        } else {</span>
<span class="fc bfc" id="L487" title="All 2 branches covered.">            if (keywordStrings.size() &gt; 0) {</span>
                //if it exists, combine the MeshHeading with the keywords
<span class="fc" id="L489">                String result = join(keywordStrings, &quot;; &quot;);</span>
<span class="fc" id="L490">                result = fields.get(FieldName.KEYWORDS) + KEYWORD_SEPARATOR + result;</span>
<span class="fc" id="L491">                fields.put(FieldName.KEYWORDS, result);</span>
            }
        }
<span class="fc" id="L494">    }</span>

    private void addOtherId(Map&lt;String, String&gt; fields, List&lt;OtherID&gt; otherID) {
<span class="fc bfc" id="L497" title="All 2 branches covered.">        for (OtherID id : otherID) {</span>
<span class="pc bpc" id="L498" title="2 of 4 branches missed.">            if ((id.getSource() != null) &amp;&amp; (id.getContent() != null)) {</span>
<span class="fc" id="L499">                fields.put(id.getSource(), id.getContent());</span>
            }
        }
<span class="fc" id="L502">    }</span>

    private void addPersonalNames(Map&lt;String, String&gt; fields, PersonalNameSubjectList personalNameSubjectList) {
<span class="fc bfc" id="L505" title="All 2 branches covered.">        if (fields.get(FieldName.AUTHOR) == null) {</span>
            //if no authors appear, then add the personal names as authors
<span class="fc" id="L507">            List&lt;String&gt; personalNames = new ArrayList&lt;&gt;();</span>
<span class="pc bpc" id="L508" title="1 of 2 branches missed.">            if (personalNameSubjectList.getPersonalNameSubject() != null) {</span>
<span class="fc" id="L509">                List&lt;PersonalNameSubject&gt; personalNameSubject = personalNameSubjectList.getPersonalNameSubject();</span>
<span class="fc bfc" id="L510" title="All 2 branches covered.">                for (PersonalNameSubject personalName : personalNameSubject) {</span>
<span class="fc" id="L511">                    String name = personalName.getLastName();</span>
<span class="pc bpc" id="L512" title="1 of 2 branches missed.">                    if (personalName.getForeName() != null) {</span>
<span class="fc" id="L513">                        name += &quot;, &quot; + personalName.getForeName().toString();</span>
                    }
<span class="fc" id="L515">                    personalNames.add(name);</span>
                }
<span class="fc" id="L517">                fields.put(FieldName.AUTHOR, join(personalNames, &quot; and &quot;));</span>
            }
        }
<span class="fc" id="L520">    }</span>

    private void addMeashHeading(Map&lt;String, String&gt; fields, MeshHeadingList meshHeadingList) {
<span class="fc" id="L523">        ArrayList&lt;String&gt; keywords = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L524" title="All 2 branches covered.">        for (MeshHeading keyword : meshHeadingList.getMeshHeading()) {</span>
<span class="fc" id="L525">            String result = keyword.getDescriptorName().getContent();</span>
<span class="pc bpc" id="L526" title="1 of 2 branches missed.">            if (keyword.getQualifierName() != null) {</span>
<span class="fc bfc" id="L527" title="All 2 branches covered.">                for (QualifierName qualifier : keyword.getQualifierName()) {</span>
<span class="fc" id="L528">                    result += &quot;, &quot; + qualifier.getContent();</span>
                }
            }
<span class="fc" id="L531">            keywords.add(result);</span>
        }
<span class="fc" id="L533">        fields.put(FieldName.KEYWORDS, join(keywords, KEYWORD_SEPARATOR));</span>
<span class="fc" id="L534">    }</span>

    private void addGeneSymbols(Map&lt;String, String&gt; fields, GeneSymbolList geneSymbolList) {
<span class="fc" id="L537">        List&lt;String&gt; geneSymbols = geneSymbolList.getGeneSymbol();</span>
<span class="fc" id="L538">        fields.put(&quot;gene-symbols&quot;, join(geneSymbols, &quot;, &quot;));</span>
<span class="fc" id="L539">    }</span>

    private void addChemicals(Map&lt;String, String&gt; fields, List&lt;Chemical&gt; chemicals) {
<span class="fc" id="L542">        List&lt;String&gt; chemicalNames = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L543" title="All 2 branches covered.">        for (Chemical chemical : chemicals) {</span>
<span class="pc bpc" id="L544" title="1 of 2 branches missed.">            if (chemical != null) {</span>
<span class="fc" id="L545">                chemicalNames.add(chemical.getNameOfSubstance().getContent());</span>
            }
        }
<span class="fc" id="L548">        fields.put(&quot;chemicals&quot;, join(chemicalNames, &quot;, &quot;));</span>
<span class="fc" id="L549">    }</span>

    private void addArticleInformation(Map&lt;String, String&gt; fields, List&lt;Object&gt; content) {
<span class="fc bfc" id="L552" title="All 2 branches covered.">        for (Object object : content) {</span>
<span class="fc bfc" id="L553" title="All 2 branches covered.">            if (object instanceof Journal) {</span>
<span class="fc" id="L554">                Journal journal = (Journal) object;</span>
<span class="fc" id="L555">                putIfValueNotNull(fields, FieldName.JOURNAL, journal.getTitle());</span>

<span class="fc" id="L557">                ISSN issn = journal.getISSN();</span>
<span class="fc bfc" id="L558" title="All 2 branches covered.">                if (issn != null) {</span>
<span class="fc" id="L559">                    putIfValueNotNull(fields, FieldName.ISSN, issn.getContent());</span>
                }

<span class="fc" id="L562">                JournalIssue journalIssue = journal.getJournalIssue();</span>
<span class="fc" id="L563">                putIfValueNotNull(fields, FieldName.VOLUME, journalIssue.getVolume());</span>
<span class="fc" id="L564">                putIfValueNotNull(fields, FieldName.ISSUE, journalIssue.getIssue());</span>

<span class="fc" id="L566">                addPubDate(fields, journalIssue.getPubDate());</span>
<span class="fc bfc" id="L567" title="All 2 branches covered.">            } else if (object instanceof ArticleTitle) {</span>
<span class="fc" id="L568">                ArticleTitle articleTitle = (ArticleTitle) object;</span>
<span class="fc" id="L569">                fields.put(FieldName.TITLE, StringUtil.stripBrackets(articleTitle.getContent().toString()));</span>
<span class="fc bfc" id="L570" title="All 2 branches covered.">            } else if (object instanceof Pagination) {</span>
<span class="fc" id="L571">                Pagination pagination = (Pagination) object;</span>
<span class="fc" id="L572">                addPagination(fields, pagination);</span>
<span class="fc bfc" id="L573" title="All 2 branches covered.">            } else if (object instanceof ELocationID) {</span>
<span class="fc" id="L574">                ELocationID eLocationID = (ELocationID) object;</span>
<span class="fc" id="L575">                addElocationID(fields, eLocationID);</span>
<span class="fc bfc" id="L576" title="All 2 branches covered.">            } else if (object instanceof Abstract) {</span>
<span class="fc" id="L577">                Abstract abs = (Abstract) object;</span>
<span class="fc" id="L578">                addAbstract(fields, abs);</span>
<span class="fc bfc" id="L579" title="All 2 branches covered.">            } else if (object instanceof AuthorList) {</span>
<span class="fc" id="L580">                AuthorList authors = (AuthorList) object;</span>
<span class="fc" id="L581">                handleAuthors(fields, authors);</span>
            }
        }
<span class="fc" id="L584">    }</span>

    private void addElocationID(Map&lt;String, String&gt; fields, ELocationID eLocationID) {
<span class="fc bfc" id="L587" title="All 2 branches covered.">        if (FieldName.DOI.equals(eLocationID.getEIdType())) {</span>
<span class="fc" id="L588">            fields.put(FieldName.DOI, eLocationID.getContent());</span>
        }
<span class="fc bfc" id="L590" title="All 2 branches covered.">        if (&quot;pii&quot;.equals(eLocationID.getEIdType())) {</span>
<span class="fc" id="L591">            fields.put(&quot;pii&quot;, eLocationID.getContent());</span>
        }
<span class="fc" id="L593">    }</span>

    private void addPubDate(Map&lt;String, String&gt; fields, PubDate pubDate) {
<span class="fc bfc" id="L596" title="All 2 branches covered.">        if (pubDate.getYear() == null) {</span>
            //if year of the pubdate is null, the medlineDate shouldn't be null
<span class="fc" id="L598">            fields.put(FieldName.YEAR, extractYear(pubDate.getMedlineDate()));</span>
<span class="fc" id="L599">        } else {</span>
<span class="fc" id="L600">            fields.put(FieldName.YEAR, pubDate.getYear());</span>
<span class="fc bfc" id="L601" title="All 2 branches covered.">            if (pubDate.getMonth() != null) {</span>
<span class="fc" id="L602">                fields.put(FieldName.MONTH, pubDate.getMonth());</span>
<span class="fc bfc" id="L603" title="All 2 branches covered.">            } else if (pubDate.getSeason() != null) {</span>
<span class="fc" id="L604">                fields.put(&quot;season&quot;, pubDate.getSeason());</span>
            }
        }
<span class="fc" id="L607">    }</span>

    private void addAbstract(Map&lt;String, String&gt; fields, Abstract abs) {
<span class="fc" id="L610">        putIfValueNotNull(fields, &quot;copyright&quot;, abs.getCopyrightInformation());</span>
<span class="fc" id="L611">        List&lt;String&gt; abstractText = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L612" title="All 2 branches covered.">        for (AbstractText text : abs.getAbstractText()) {</span>
<span class="fc bfc" id="L613" title="All 2 branches covered.">            for (Serializable textContent : text.getContent()) {</span>
<span class="fc bfc" id="L614" title="All 2 branches covered.">                if (textContent instanceof String) {</span>
<span class="fc" id="L615">                    abstractText.add((String) textContent);</span>
                }
            }
        }
<span class="fc" id="L619">        fields.put(FieldName.ABSTRACT, join(abstractText, &quot; &quot;));</span>
<span class="fc" id="L620">    }</span>

    private void addPagination(Map&lt;String, String&gt; fields, Pagination pagination) {
<span class="fc" id="L623">        String startPage = &quot;&quot;;</span>
<span class="fc" id="L624">        String endPage = &quot;&quot;;</span>
<span class="fc bfc" id="L625" title="All 2 branches covered.">        for (JAXBElement&lt;String&gt; element : pagination.getContent()) {</span>
<span class="fc bfc" id="L626" title="All 2 branches covered.">            if (&quot;MedlinePgn&quot;.equals(element.getName().getLocalPart())) {</span>
<span class="fc" id="L627">                putIfValueNotNull(fields, FieldName.PAGES, fixPageRange(element.getValue()));</span>
<span class="fc bfc" id="L628" title="All 2 branches covered.">            } else if (&quot;StartPage&quot;.equals(element.getName().getLocalPart())) {</span>
                //it could happen, that the article has only a start page
<span class="fc" id="L630">                startPage = element.getValue() + endPage;</span>
<span class="fc" id="L631">                putIfValueNotNull(fields, FieldName.PAGES, startPage);</span>
<span class="pc bpc" id="L632" title="1 of 2 branches missed.">            } else if (&quot;EndPage&quot;.equals(element.getName().getLocalPart())) {</span>
<span class="fc" id="L633">                endPage = element.getValue();</span>
                //but it should not happen, that a endpage appears without startpage
<span class="fc" id="L635">                fields.put(FieldName.PAGES, fixPageRange(startPage + &quot;-&quot; + endPage));</span>
            }
        }
<span class="fc" id="L638">    }</span>

    private String extractYear(String medlineDate) {
        //The year of the medlineDate should be the first 4 digits
<span class="fc" id="L642">        return medlineDate.substring(0, 4);</span>
    }

    private void handleAuthors(Map&lt;String, String&gt; fields, AuthorList authors) {
<span class="fc" id="L646">        List&lt;String&gt; authorNames = new ArrayList&lt;&gt;();</span>
<span class="fc bfc" id="L647" title="All 2 branches covered.">        for (Author author : authors.getAuthor()) {</span>
<span class="fc bfc" id="L648" title="All 2 branches covered.">            if (author.getCollectiveName() != null) {</span>
<span class="fc" id="L649">                Text collectiveNames = author.getCollectiveName();</span>
<span class="fc bfc" id="L650" title="All 2 branches covered.">                for (Serializable content : collectiveNames.getContent()) {</span>
<span class="pc bpc" id="L651" title="1 of 2 branches missed.">                    if (content instanceof String) {</span>
<span class="fc" id="L652">                        authorNames.add((String) content);</span>
                    }
                }
<span class="fc" id="L655">            } else {</span>
<span class="fc" id="L656">                String authorName = author.getLastName();</span>
<span class="fc bfc" id="L657" title="All 2 branches covered.">                if (author.getForeName() != null) {</span>
<span class="fc" id="L658">                    authorName += &quot;, &quot; + author.getForeName();</span>
                }
<span class="fc" id="L660">                authorNames.add(authorName);</span>
            }
        }
<span class="fc" id="L663">        fields.put(FieldName.AUTHOR, join(authorNames, &quot; and &quot;));</span>
<span class="fc" id="L664">    }</span>

    private void addDateRevised(Map&lt;String, String&gt; fields, DateRevised dateRevised) {
<span class="pc bpc" id="L667" title="3 of 6 branches missed.">        if ((dateRevised.getDay() != null) &amp;&amp; (dateRevised.getMonth() != null) &amp;&amp; (dateRevised.getYear() != null)) {</span>
<span class="fc" id="L668">            fields.put(&quot;revised&quot;,</span>
<span class="fc" id="L669">                    convertToDateFormat(dateRevised.getYear(), dateRevised.getMonth(), dateRevised.getDay()));</span>
        }
<span class="fc" id="L671">    }</span>

    private void putIfValueNotNull(Map&lt;String, String&gt; fields, String medlineKey, String value) {
<span class="fc bfc" id="L674" title="All 2 branches covered.">        if (value != null) {</span>
<span class="fc" id="L675">            fields.put(medlineKey, value);</span>
        }
<span class="fc" id="L677">    }</span>

    /**
     * Convert medline page ranges from short form to full form.
     * Medline reports page ranges in a shorthand format.
     * The last page is reported using only the digits which
     * differ from the first page.
     * i.e. 12345-51 refers to the actual range 12345-12351
     */
    private String fixPageRange(String pageRange) {
<span class="fc" id="L687">        int minusPos = pageRange.indexOf('-');</span>
<span class="fc bfc" id="L688" title="All 2 branches covered.">        if (minusPos &lt; 0) {</span>
<span class="fc" id="L689">            return pageRange;</span>
        }
<span class="fc" id="L691">        String startPage = pageRange.substring(0, minusPos).trim();</span>
<span class="fc" id="L692">        String endPage = pageRange.substring(minusPos + 1).trim();</span>
<span class="fc" id="L693">        int lengthOfEndPage = endPage.length();</span>
<span class="fc" id="L694">        int lengthOfStartPage = startPage.length();</span>
<span class="fc bfc" id="L695" title="All 2 branches covered.">        if (lengthOfEndPage &lt; lengthOfStartPage) {</span>
<span class="fc" id="L696">            endPage = startPage.substring(0, lengthOfStartPage - lengthOfEndPage) + endPage;</span>
        }
<span class="fc" id="L698">        return startPage + &quot;--&quot; + endPage;</span>
    }

    @Override
    public List&lt;BibEntry&gt; parseEntries(InputStream inputStream) throws ParseException {
        try {
<span class="fc" id="L704">            return importDatabase(</span>
<span class="fc" id="L705">                    new BufferedReader(new InputStreamReader(inputStream, StandardCharsets.UTF_8))).getDatabase().getEntries();</span>

<span class="nc" id="L707">        } catch (IOException e) {</span>
<span class="nc" id="L708">            LOGGER.error(e.getLocalizedMessage(), e);</span>
        }
<span class="nc" id="L710">        return Collections.emptyList();</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.9.201702052155</span>java (11/05/2018 16:12:58)</div></body></html>